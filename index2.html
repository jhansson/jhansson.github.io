<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Jimmy Hansson - Gameplay designer &amp; scripter</title>
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link href="css/simple-grid.min.css" rel="stylesheet">
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/animate.css/3.2.0/animate.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    <link href="css/main.css?poop=1" rel="stylesheet">
    <link rel="stylesheet" href="css/baguetteBox.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>    
  </head>
  <body>
  <div class="background-thing"></div>
  <div class="container">
      <div class="row">
        <div class="col-12">
          <!-- TOP BOX START -->
          <div class="shadow-box">
            <div class="row">
              <div class="col-5 no-margin-col">
                <div class="faceshot"></div>
              </div>
              <div class="col-7">
                <div class="about-me">
                  <span class="hello-box">Hello!</span>
                  <h1 class="font-light">I'm <span class="font-heavy">Jimmy Hansson</span></h1>
                  <span class="subtitle">Technical Game Designer @ Coffee Stain North</span>
                  <p>
                    I'm a technical game designer with an interest in developing games and systems
                    with the user experience in focus. I'm currently working on Goat Simulator 3.
                  </p>
                  <div>
                      <span class="chip">
                          <span class="chip__text">Unreal Engine</span>
                      </span>
                      <span class="chip">
                          <span class="chip__text">Blueprint</span>
                      </span>
                      <span class="chip">
                          <span class="chip__text">Unity</span>
                      </span>
                      <span class="chip">
                          <span class="chip__text">C#</span>
                      </span>
                      <span class="chip">
                          <span class="chip__text">UX</span>
                      </span>
                  </div>
                  <div style="margin-top: 15px">
                    <a class="linkedin" href="http://www.linkedin.com/in/jimmy-s-hansson">
                      <img src="icons/linkedin.png" alt="My LinkedIn account" class="initial loading" data-was-processed="true">
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- TOP BOX END -->          
        </div>
      </div>
      <h2 class="projects-header">Work</h2>
          <!-- PROJECTS START -->
          <div class="row">

            <!-- Goat Simulator 3 -->
            <div class="col-12">
              <div class="demo-card-wide mdl-card mdl-shadow--2dp">
                <div class="mdl-card__title">
                  <h2 class="mdl-card__title-text">Goat Simulator 3</h2>
                </div>
                <div class="mdl-card__supporting-text">
                  <div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
                    <div class="mdl-tabs__tab-bar">
                      <a href="#video-panel" class="mdl-tabs__tab is-active">Video</a>
                      <a href="#desc-panel" class="mdl-tabs__tab">What I do</a>
                    </div>                          
                    <div class="mdl-tabs__panel is-active" id="video-panel">
                      <iframe width="560" height="315" src="https://www.youtube.com/embed/f7usqADIp1g?rel=0&amp;showinfo=0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                    </div>
                    <div class="mdl-tabs__panel" id="desc-panel">
                      <h3>Technical Game Designer</h3>
                      <p>
                          I am a Technical Game Designer at Coffee Stain North, actively involved in the development of Goat
                          Simulator 3. 
                      </p>
                      <p>
                          In this role, I do brainstorming, design, prototyping, and implementing game mechanics, fixing
                          bugs, while also acting as a bridge between designers, artists, and programmers.
                      </p>                      
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
             <!-- START Moving to S -->
            <div class="col-12">
              <div class="demo-card-wide mdl-card mdl-shadow--2dp">
                <div class="mdl-card__title">
                  <h2 class="mdl-card__title-text">Moving to Sweden (unreleased)</h2>
                </div>
                <div class="mdl-card__supporting-text">
                  <div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
                    <div class="mdl-tabs__tab-bar">
                      <a href="#video-panel" class="mdl-tabs__tab is-active">Video</a>
                      <a href="#desc-panel" class="mdl-tabs__tab">Description</a>
                    </div>                          
                    <div class="mdl-tabs__panel is-active" id="video-panel">
                      <iframe width="660" height="315" src="https://www.youtube.com/embed/nRS-iI4quSE?rel=0&amp;showinfo=0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                    </div>
                    <div class="mdl-tabs__panel" id="desc-panel">
                        <h3>What it is</h3>
                        <p>
                            Moving to Sweden is a game I worked on before I joined Coffee Stain North. The year is 1988 and you move to a small run down village in the Swedish countryside. It's a lighthearted game about starting over, making a home and bringing hope.
                        </p>
                        <h3>What I did</h3>
                        <p>
                          Pre production: Game Design Document that describes story, gameplay, 
                          player character, game world, game experience, game mechanics,  
                          art style, music, sound and target audience with personas.
                        </p>
                        <p>
                          The game is made in Unreal Engine 4 and features several custom made systems made mainly in Blueprint, but also some in C++. 
                          Some of the systems: 
                          * Interactions
                          * Smart placement of objects when decorating
                          * Inventory
                          * Customizing (wallpapers, painting)
                          * Building (mount windows, install things into slots etc)
                          * Cleaning 
                          Many of the systems enables the player to be a handyman, like the above systems. But there are also other general systems like weather, calendar, events, shops and dialogues that helps the world come alive.
                        
                        </p>
                      <p>
                        It was a fun game to work on and I learned a lot. Maybe I'll come back and finish it sometime in the future. Who knows!
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Moving end end -->
            
            <!-- Proj Y start -->
            <div class="col-6">
              <div class="demo-card-wide mdl-card mdl-shadow--2dp">
                <div class="mdl-card__title">
                  <h2 class="mdl-card__title-text">Movement and Interaction Syste</h2>
                </div>
                <div class="mdl-card__supporting-text">
                  <div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
                    <div class="mdl-tabs__tab-bar">
                      <a href="#video-panel" class="mdl-tabs__tab is-active">Video</a>
                      <a href="#desc-panel" class="mdl-tabs__tab">Description &amp; Code</a>
                    </div>                          
                    <div class="mdl-tabs__panel is-active" id="video-panel">
                      <iframe width="560" height="315" src="https://www.youtube.com/embed/JCbnJnLDAqU?rel=0&amp;showinfo=0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                    </div>
                    <div class="mdl-tabs__panel" id="desc-panel">
                      <h3>What it is</h3>
                      <p>
                          A game called Echo which focused on environmental storytelling made in Unreal Engine 4.
                      </p>
                      <h3>What I did</h3>
                      <p>
                        I was mainly responsible for the character movement and interactions. 
                        The movement is a custom made physics based system that allows for more realistic
                        and predictable interactions with the environment than with the default Unreal character.
                      </p>
                      <p>
                        The goal for interacting with objects was to get a fairly realistic movement where it look 
                        and feel like you as a player are dragging around a physical object.
                      </p>
                      <p>
                        Physics constraints are used to attach the object to the player and IK is then used on the 
                        hands and arms to position them on the object's surface. Raycasting is used to get locations.
                      </p>  
                      <p>Part of Blueprint code to grab an object:</p>
                      <div class="gallery">
                        <a href="images/grabbing01.png" data-caption="Part of Blueprint for grabbing objects">
                          <img src="images/grabbing01.png" class="blueprint-image" alt="Part of Blueprint for grabbing objects"/>
                        </a>
                      </div>
                      <p>Blueprint for IK on arms when grabbing an object:</p>
                      <div class="gallery">
                        <a href="images/grabbing02ik.png" data-caption="Blueprint for IK on character arms">
                          <img src="images/grabbing02ik.png" class="blueprint-image" alt="Blueprint for IK on character arms"/>
                        </a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Proj Y end -->
          </div>

          <h2 class="projects-header">Older projects</h2>
          <div class="row">           
            
            <!-- START NIMBLE HANDS -->
            <div class="col-6">
              <div class="demo-card-wide mdl-card mdl-shadow--2dp">
                <div class="mdl-card__title">
                  <h2 class="mdl-card__title-text">Nimble Hands - Physics Based Thief Game</h2>
                </div>
                <div class="mdl-card__supporting-text">
                  <div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
                    <div class="mdl-tabs__tab-bar">
                      <a href="#video-panel" class="mdl-tabs__tab is-active">Video</a>
                      <a href="#desc-panel" class="mdl-tabs__tab">Description</a>
                    </div>                          
                    <div class="mdl-tabs__panel is-active" id="video-panel">
                      <iframe width="660" height="315" src="https://www.youtube.com/embed/nRS-iI4quSE?rel=0&amp;showinfo=0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                    </div>
                    <div class="mdl-tabs__panel" id="desc-panel">
                        <h3>What it is</h3>
                        <p>
                            Nimble Hands is a game where you as a thief has to navigate tight spaces with your ever growing physics based sack of loot.
                        </p>
                        <h3>What I did</h3>
                        <p>
                          A ten page Game Design Document that describes story, gameplay, unique mechanics, 
                          player character, game world, game experience, game mechanics, enemies and challenges,  
                          level design, art style, music, sound, target audience and monitization.
                        </p>
                        <p>
                          I also created the prototypes in the video to showcase the fun factor with a physics based sack. 
                          The first prototype was made in Unreal Engine and the more finished version was made in Unity.
                        </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Nimble Hands end -->
            
            <!-- Echo start -->
            <div class="col-6">
              <div class="demo-card-wide mdl-card mdl-shadow--2dp">
                <div class="mdl-card__title">
                  <h2 class="mdl-card__title-text">Movement and Interaction System</h2>
                </div>
                <div class="mdl-card__supporting-text">
                  <div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
                    <div class="mdl-tabs__tab-bar">
                      <a href="#video-panel" class="mdl-tabs__tab is-active">Video</a>
                      <a href="#desc-panel" class="mdl-tabs__tab">Description &amp; Code</a>
                    </div>                          
                    <div class="mdl-tabs__panel is-active" id="video-panel">
                      <iframe width="560" height="315" src="https://www.youtube.com/embed/JCbnJnLDAqU?rel=0&amp;showinfo=0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                    </div>
                    <div class="mdl-tabs__panel" id="desc-panel">
                      <h3>What it is</h3>
                      <p>
                          A game called Echo which focused on environmental storytelling made in Unreal Engine 4.
                      </p>
                      <h3>What I did</h3>
                      <p>
                        I was mainly responsible for the character movement and interactions. 
                        The movement is a custom made physics based system that allows for more realistic
                        and predictable interactions with the environment than with the default Unreal character.
                      </p>
                      <p>
                        The goal for interacting with objects was to get a fairly realistic movement where it look 
                        and feel like you as a player are dragging around a physical object.
                      </p>
                      <p>
                        Physics constraints are used to attach the object to the player and IK is then used on the 
                        hands and arms to position them on the object's surface. Raycasting is used to get locations.
                      </p>  
                      <p>Part of Blueprint code to grab an object:</p>
                      <div class="gallery">
                        <a href="images/grabbing01.png" data-caption="Part of Blueprint for grabbing objects">
                          <img src="images/grabbing01.png" class="blueprint-image" alt="Part of Blueprint for grabbing objects"/>
                        </a>
                      </div>
                      <p>Blueprint for IK on arms when grabbing an object:</p>
                      <div class="gallery">
                        <a href="images/grabbing02ik.png" data-caption="Blueprint for IK on character arms">
                          <img src="images/grabbing02ik.png" class="blueprint-image" alt="Blueprint for IK on character arms"/>
                        </a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Echo end -->
            
          </div>
          <div class="row">
            <!-- START ENEMY AI WITH GOAP -->
              <div class="col-6">
                  <div class="demo-card-wide mdl-card mdl-shadow--2dp">
                    <div class="mdl-card__title">
                      <h2 class="mdl-card__title-text">Enemy AI with GOAP</h2>
                    </div>
                    <div class="mdl-card__supporting-text">
                      <div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
                        <div class="mdl-tabs__tab-bar">
                          <a href="#video-panel" class="mdl-tabs__tab is-active">Video</a>
                          <a href="#desc-panel" class="mdl-tabs__tab">Description &amp; Code</a>
                        </div>                          
                        <div class="mdl-tabs__panel is-active" id="video-panel">
                          <iframe width="660" height="315" src="https://www.youtube.com/embed/idcmk7gtxYw?rel=0&amp;showinfo=0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                        </div>
                        <div class="mdl-tabs__panel" id="desc-panel">
                            <h3>What it is</h3>
                            <p>
                              FPS arena shooter with AI made with Goal Oriented Action Planning.
                              10 day project made in Unity and C#.
                            </p>
                            <h3>What I did</h3>
                            <p>
                              Created a FPS controller and a procedural generated map for fast paced action.
                              The AI is made with ReGoap and inspired by the AI in Fear.
                            </p>
                            <p><strong>Example code to look for cover positions to add to memory of agent:</strong></p>
                            <div class="accordionItem close">
                                <h2 class="accordionItemHeading">Show/Hide Code</h2>
                                <div class="accordionItemContent">
                                    <div class="snipped-code">
                                        <pre>
                                          <code class="language-csharp">
...
// Sensor for remembering reachable cover positions
// Find "edges" in navmesh and see if they can cover you in the player direction
if (NavMesh.FindClosestEdge(transform.position, out defensiveEdgeHit, NavMesh.AllAreas))
{
    for (int i = 0; i < numCoverPositions; i++)
    {
        RaycastHit hit;
        Vector2 randomPosCircle = (Random.insideUnitCircle * searchArea);
        Vector3 randomPos = new Vector3(randomPosCircle.x, groundLevel, randomPosCircle.y);
        NavMeshHit navHit;

        if (NavMesh.SamplePosition(defensiveEdgeHit.position + (-directionToPlayer) + randomPos, out navHit, searchRadius, NavMesh.AllAreas))
        {
            var direction = pc.transform.position - navHit.position / heading.magnitude;

            if (Physics.Raycast(navHit.position + new Vector3(0, 0.5f, 0), direction, out hit, 40f))
            {
                // Only ArenaBlocks can be between player and AI
                if (hit.collider.CompareTag("ArenaBlock"))
                {
                    memory.GetWorldState().Set(SENSOR_TYPE.DEFENSIVE_COVER_POSITION, defensiveCoverPosition);
                    break;
                }
            }
        }
    }
}
...
                                          </code>
                                        </pre>
                                      </div>
                                </div>
                              </div>
                              <p><strong>Example code for go to cover action:</strong></p>
                              <div class="accordionItem close">
                                  <h2 class="accordionItemHeading">Show/Hide Code</h2>
                                  <div class="accordionItemContent">
                                      <div class="snipped-code">
                                          <pre>
                                            <code class="language-csharp">
...
protected override void Awake()
{
  ...
  // Set required preconditions and effects if succesful action
  preconditions.Set(SENSOR_TYPE.LAST_POSITION_KNOWN, true);
  preconditions.Set(SENSOR_TYPE.CAN_NOT_SEE_TARGET, true);
  preconditions.Set(SENSOR_TYPE.NOT_CLOSE_LAST_SEEN_POSITION, true);
  effects.Set(SENSOR_TYPE.IS_IN_COVER, true);
  effects.Set(SENSOR_TYPE.TARGET_IS_NOT_AIMING_AT_ME, true);
}
...
public void Update(...)
{
  // LAST_SEEN_POSITION has been updated while moving to cover: exit out this action
  if (lastTargetLocation != (Vector3)agent.GetMemory().GetWorldState().Get(SENSOR_TYPE.LAST_SEEN_POSITION))
  {
      failCallback(this);
  }

  // Has a cover position to move to
  if (coverPos != Vector3.zero)
  {
      // Cover has been reached
      if (Vector3.Distance(transform.position, coverPos) < maxDistanceInCover)
      {
          agent.GetMemory().GetWorldState().Set(SENSOR_TYPE.MOVING_TOWARDS_COVER, false);
          agent.GetMemory().GetWorldState().Set(SENSOR_TYPE.IS_IN_COVER, true);

          ...
          
          // Been in cover long enough
          if (coverTimerStarted && Time.time > timeToCover)
          {
              agent.GetMemory().GetWorldState().Set(SENSOR_TYPE.IS_IN_COVER, false);
              coverTimerStarted = false;
              doneCallback(this);
          }                

          // Exit cover if target is aiming at me
          if (coverTimerStarted && (bool)agent.GetMemory().GetWorldState().Get(SENSOR_TYPE.TARGET_IS_AIMING_AT_ME))
          {
              failCallback(this);
          }
      }
  }
  ...
}
...
                                            </code>
                                          </pre>
                                        </div>
                                  </div>
                                </div>
                          <h3>What I learned</h3>
                          <p>I really enjoyed working with GOAP. It gives a flexibility to the AI which is 
                            harder to reach with Behaviour Trees or similar AI solutions.</p>
                            <p>
                              I still think there is too much "hard coding" for me in how the actions are being performed and 
                              that preconditions and effects are prone to errors. I think the philosophy behind GOAP coupled with Machine Learning
                              will solve a lot of the issues.
                            </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- END GOAP  -->
                <!-- START ML GOLFER -->
                <div class="col-6">
                  <div class="demo-card-wide mdl-card mdl-shadow--2dp">
                    <div class="mdl-card__title">
                      <h2 class="mdl-card__title-text">Machine Learning: Golf</h2>
                    </div>
                    <div class="mdl-card__supporting-text">
                      <div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
                        <div class="mdl-tabs__tab-bar">
                          <a href="#video-panel" class="mdl-tabs__tab is-active">Video</a>
                          <a href="#desc-panel" class="mdl-tabs__tab">Description &amp; Code</a>
                        </div>                          
                        <div class="mdl-tabs__panel is-active" id="video-panel">
                          <iframe width="660" height="315" src="https://www.youtube.com/embed/SE4Kzsz61q8?rel=0&amp;showinfo=0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                        </div>
                        <div class="mdl-tabs__panel" id="desc-panel">
                            <h3>What it is</h3>
                            <p>
                              AI that has learned to play simple golf by using Machine Learning. Result is from around 30 minutes of training only.
                            </p>
                            <h3>What I did</h3>
                            <p>
                              I used Unity and ml-agents to train the AI. I made a training environment that used
                              curriculum training to teach the AI in steps. First it had the green (goal) close by
                              in the same position making it easy to accidentally hit it. When the AI had high enough success rate, the next stage started
                              where the green was randomized in position. This way it could realize that it was
                              not the world position that was important, but the actual position of the green in the world.
                            </p>
                            <p>After several different lessons that gradually made things harder and introduced more challenges,
                              the AI could play randomly generated maps with high success rate even when I added randomness in 
                              how clean the ball was hit.
                            </p>

                          <p><strong>Code for the AI observations:</strong></p>
                          <div class="accordionItem close">
                              <h2 class="accordionItemHeading">Show/Hide Code</h2>
                              <div class="accordionItemContent">
                                  <div class="snipped-code">
                                      <pre>
                                        <code class="language-csharp">
public override void CollectObservations()
{
    float rayDistance = 5f;
    float[] rayAngles = { 0f, 45f, 90f, 135f, 180f, 225f, 270f, 315f };
    float[] rayAnglesOffset = { 0f + 22.5f, 45f + 22.5f, 90f + 22.5f, 135f + 22.5f, 180f + 22.5f, 225f + 22.5f, 270f + 22.5f, 315f + 22.5f };
    string[] detectableObjects;
    detectableObjects = new string[] { "ground", "goal", "fairway" };

    // Raytracing environment in different angles
    AddVectorObs(rayGridPer.Perceive(1f, rayAngles, detectableObjects, 0f, 7f));
    AddVectorObs(rayGridPer.Perceive(2f, rayAnglesOffset, detectableObjects, 0f, 7f));
    AddVectorObs(rayGridPer.Perceive(3f, rayAngles, detectableObjects, 0f, 7f));
    AddVectorObs(rayGridPer.Perceive(6f, rayAnglesOffset, detectableObjects, 0f, 7f));
    AddVectorObs(rayGridPer.Perceive(10f, rayAngles, detectableObjects, 0f, 7f));

    // Observe relations in distance between different objects
    AddVectorObs(target.transform.position - goal.transform.position);
    AddVectorObs(goal.transform.position - area.transform.position);
    AddVectorObs(Vector3.Distance(target.transform.position, goal.transform.position));
    AddVectorObs(maxTargetDistance - targetDistance);

    AddVectorObs(shotCount);
    AddVectorObs(decisionCounter);

    // Observe if the predicted trajectory hits something
    aimingAtObstacle = 0f;
    for (int i = 0; i < launchArcRenderer.lr.positionCount; i++)
    {
        float hitSomething = 0.0f;
        Collider[] hits = Physics.OverlapSphere(launchArcRenderer.lr.GetPosition(i), 0.3f);
        if (hits.Length > 0)
        {
            if (hits[0].CompareTag("obstacle"))
            {
                hitSomething = 1.0f;
                aimingAtObstacle = 1.0f;
            }                
        }
        AddVectorObs(hitSomething);
    }

    AddVectorObs(aimingAtObstacle);
}
                                        </code>
                                      </pre>
                                    </div>
                              </div>
                            </div>
                            <h3>What I learned</h3>
                            <p>It's easy for the AI to come to the wrong conclusions about what the different observations actually means.
                              A lot of trial and error was needed to find a balance between the observations. It's easy to "overload" the AI.
                            </p>
                              <p>
                                Curriculum learning where the AI goes through serveral lessons that gets gradually harder is very effective 
                                to reach the end goal in much less time than without it if the challenge is fairly hard.
                              </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
          <!-- END ML GOLF -->
          
          <div class="row">
            <!-- START REALISTIC BALL PHYSICS -->
            <div class="col-6">
                <div class="demo-card-wide mdl-card mdl-shadow--2dp">
                  <div class="mdl-card__title">
                    <h2 class="mdl-card__title-text">Realistic ball physics for sports</h2>
                  </div>
                  <div class="mdl-card__supporting-text">
                    <div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
                      <div class="mdl-tabs__tab-bar">
                        <a href="#video-panel" class="mdl-tabs__tab is-active">Video</a>
                        <a href="#desc-panel" class="mdl-tabs__tab">Description &amp; Code</a>
                      </div>                          
                      <div class="mdl-tabs__panel is-active" id="video-panel">
                        <iframe width="660" height="315" src="https://www.youtube.com/embed/pfkqlZy90J4?rel=0&amp;showinfo=0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                      </div>
                      <div class="mdl-tabs__panel" id="desc-panel">
                          <h3>What it is</h3>
                          <p>
                            I like simulations. I like golf. I like football. So I wanted to create ball physics that tries to simulate realistic flight trajectory.
                            Made in Unity and C#.
                          </p>
                          <h3>What I did</h3>
                          <p>
                            I read many papers about ball flight and tried to integrate them to work together with Unity's own physics.
                            The physics of the ball flight uses things like temperature, air density, Reynolds Number, bunch of different coefficients and frictions
                             to calculate magnus force and spin.
                          </p>
                          <p>
                            Each golf club also has its own mass, loft and ECOR value that has different impact on the ball. Depending on the club 
                            swing angle, spin is added to the ball and can result in slicing and hooking the ball.
                          </p>
                          <p><strong>One part of calculating ball flight:</strong></p>
                          <div class="accordionItem close">
                              <h2 class="accordionItemHeading">Show/Hide Code</h2>
                              <div class="accordionItemContent">
                                  <div class="snipped-code">
                                      <pre>
                                        <code class="language-csharp">
Vector3 DragAndMagnusForce() {
  // Compute the apparent velocity magnitude.
  velocityMagnitude = rigidBody.velocity.magnitude + 0000000.1f;

  // Compute the total drag force and the dirctional drag.
  totalDragForce = 0.5f * density * area * cd * (velocityMagnitude * velocityMagnitude);
  directionalDrag = -totalDragForce * rigidBody.velocity / (velocityMagnitude);

  //  Evaluate the Magnus force terms.
  rotationSpinRatio = Mathf.Abs(radius * (rigidBody.angularVelocity.magnitude) / (velocityMagnitude));
  liftCoefficient = -0.05f + Mathf.Sqrt(0.0025f + 0.36f * (rotationSpinRatio));
  magnusForceCoefficient = 0.5f * density * area * liftCoefficient * (velocityMagnitude * velocityMagnitude);     
  magnusForce = magnusForceCoefficient * Vector3.Cross(rigidBody.angularVelocity, rigidBody.velocity).normalized;

  // Return directional drag and magnus force       
  return new Vector3(
      magnusForce.x + directionalDrag.x,
      magnusForce.y + directionalDrag.y,
      magnusForce.z + directionalDrag.z
  );        
}
                                        </code>
                                      </pre>
                                    </div>
                              </div>
                            </div>
                            <p><strong>Code to calculate force from golf club:</strong></p>
                          <div class="accordionItem close">
                              <h2 class="accordionItemHeading">Show/Hide Code</h2>
                              <div class="accordionItemContent">
                                  <div class="snipped-code">
                                      <pre>
                                        <code class="language-csharp">
public void CalculateClubCollision(GolfBall golfBall)
{
    Rigidbody golfBallRb = golfBall.GetComponent<Rigidbody>();
    // Convert the loft angle from degrees to radians and
    // assign values to some convenience variables.
    float loftRadians = (loft + ballHitAngle) * Mathf.PI / 180.0f;
    float clubFaceAngleRadians = clubFaceAngle * Mathf.PI / 180.0f;
    float swingAngleRadians = swingAngle * Mathf.PI / 180.0f;
    float ballAngle = (loft - ballHitAngle) * Mathf.PI / 180.0f;
    float cosL = Mathf.Cos(loftRadians);
    float sinL = Mathf.Sin(loftRadians);
    float sinL2 = Mathf.Sin(ballAngle);

    //  Calculate the pre-collision velocities normal and parallel to the line of action.
    float velocityClubParallel = cosL * shotPower;
    float velocityClubNormal = -sinL * shotPower;
    float vcn2 = -sinL2 * shotPower;
    float vcnAngle = Mathf.Sin(clubFaceAngleRadians + swingAngleRadians) * shotPower;

    //  Compute the post-collision velocity of the ball along the line of action.
    float velocityBallParallel = (1.0f + ecor) * clubMass * velocityClubParallel / (clubMass + golfBall.GetComponent<Rigidbody>().mass);

    //  Compute the post-collision velocity of the ball perpendicular to the line of action.
    float velocityBallNormal = (5.0f / 7.0f) * clubMass * velocityClubNormal / (clubMass + golfBall.GetComponent<Rigidbody>().mass);

    // Spin
    float omega = (5.0f / 7.0f) * velocityClubNormal / (golfBall.radius);
    float omegaSide = (5.0f / 7.0f) * vcnAngle / (golfBall.radius);

    //  Rotate post-collision ball velocities back into standard Cartesian frame of reference.
    float vx0 = 0f;
    float vy0 = (sinL * velocityBallParallel) + (cosL * velocityBallNormal);
    float vz0 = (cosL * velocityBallParallel) - (sinL * velocityBallNormal);

    // Set the direction of the ball depending on aiming direction and swing angle.
    Vector3 directionToAim = -transform.right + (rb.velocity.normalized * 0.15f);
    directionToAim.y = 0;
    directionToAim = Quaternion.AngleAxis(swingAngle, Vector3.up) * directionToAim;
    float angle = Vector3.Angle(directionToAim, Vector3.forward) + swingAngle;
    directionToAim = directionToAim.normalized;
    angle = (directionToAim.x < 0) ? -angle : angle;

    // Set velocity on golf ball
    golfBallRb.velocity = new Vector3(vz0 * directionToAim.x, vy0, vz0 * directionToAim.z);

    // Set the spin of the ball that is generated by the club impact.
    golfBallRb.angularVelocity = new Vector3(
        omega * Mathf.Cos(angle * Mathf.PI / 180.0f),
        omegaSide,
        omega * -Mathf.Sin(angle * Mathf.PI / 180.0f)
    );
}
                                        </code>
                                      </pre>
                                    </div>
                              </div>
                            </div>

                      </div>
                    </div>
                  </div>
                </div>
              </div>
            <!-- END BALL PHYSICS -->
          <!-- START GAMEPLAY SCRIPTER IN THROW MOTION -->
          <div class="col-6">
              <div class="demo-card-wide mdl-card mdl-shadow--2dp">
                <div class="mdl-card__title">
                  <h2 class="mdl-card__title-text">Climbing System in Unreal Engine 4</h2>
                </div>
                <div class="mdl-card__supporting-text">
                  <div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
                    <div class="mdl-tabs__tab-bar">
                      <a href="#video-panel" class="mdl-tabs__tab is-active">Video</a>
                      <a href="#desc-panel" class="mdl-tabs__tab">Description &amp; Code</a>
                    </div>                          
                    <div class="mdl-tabs__panel is-active" id="video-panel">
                      <iframe width="660" height="315" src="https://www.youtube.com/embed/-cVRhMPvjho?rel=0&amp;showinfo=0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                    </div>
                    <div class="mdl-tabs__panel" id="desc-panel">
                      <h3>What it is</h3>
                      <p>
                        Inspired by games like Shadow of the Colossus and The Legend of Zelda: Breath of the Wild
                        I've created a Blueprint based climbing system in Unreal Engine 4. Being able to climb freely
                        gives the player a lot of interesting ways to explore the world.
                    </p>
                    <h3>What I did</h3>
                    <p>
                      A system that lets the player climb freely on any surface in the world. The surfaces can 
                      be static or moving. The climbing is activated when moving into a climbable object within a certain
                      angle threshold between the climbable normal and the way the player looks. Raycasting is then used to 
                      check if it's possible to climb in the input direction. If possible, a helper will be created at the 
                      local position of the raycast hit in the object being climbed upon. This way when we lerp to this position,
                      it doesn't matter if the object moves, we always have the local position stored.
                    </p>    
                    <p><strong>Main blueprint in climbing component:</strong></p>
                    <div class="accordionItem close">
                      <h2 class="accordionItemHeading">Show/Hide Code</h2>
                      <div class="accordionItemContent">
                          <iframe src="https://blueprintue.com/render/fsalmp60" height="500" scrolling="no"></iframe>
                      </div>
                    </div>
                    <h3>What I learned</h3>                        
                    <p>
                      Creating more advanced features in Blueprint is not easy and clearly not what it is designed for.
                      Many of the complicated blueprints could have been written in a few lines of C#.
                    </p>
                    <p>
                      I have gained a lot of knowledge of Blueprint and can appreciate the power of visual scripting.
                    </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- START FREE CLIMB SYSTEM -->
          <div class="row">
              <div class="col-6">
                  <div class="demo-card-wide mdl-card mdl-shadow--2dp">
                    <div class="mdl-card__title">
                      <h2 class="mdl-card__title-text">Gameplay Scripter in "Throw Motion"</h2>
                    </div>
                    <div class="mdl-card__supporting-text">
                      <div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
                        <div class="mdl-tabs__tab-bar">
                          <a href="#video-panel" class="mdl-tabs__tab is-active">Video</a>
                          <a href="#desc-panel" class="mdl-tabs__tab">Description</a>
                        </div>                          
                        <div class="mdl-tabs__panel is-active" id="video-panel">
                          <iframe width="660" height="315" src="https://www.youtube.com/embed/SwNvQGzgMQw?rel=0&amp;showinfo=0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                        </div>
                        <div class="mdl-tabs__panel" id="desc-panel">
                            <h3>What it is</h3> 
                          <p>
                            It was developed in four weeks by a team of game designers and 3d artists. 
                            It's a 1-4 player party game where the two sports of dodgeball and figure skating has been mashed together.
                          </p>
                      
                        <h3>What I did</h3>                      
                          <p>
                            I was mainly responsible for the character movement, game rules and camera functionalities.
                          </p>
                          <p>
                              The aim for the movement was to find a good balance between sliding on the ice but still
                              have responsive controls. Character movement is based on the Unreal character movement with 
                              modifications to make it feel like you're sliding around on ice.
                          </p>
                          <p>
                            For the camera I set up blueprint to make the camera zoom in and out depending on where the 
                            players are, making sure they are all in frame of the camera. This way the camera gets closer
                            to the action when all players are close to each other.
                          </p>   
                        <h3>What I learned</h3>                        
                        <p>
                          In intensive party games, it's better to go for more arcade feeling in the controls. 
                          The user experience was affected negatively by having the players slide to much on the ice.
                          By making the controls more responsive the players would have felt more in control of their characters.
                        </p>
                        <p>
                          I also learned that you can make a pretty good prototype for a game in two weeks with
                          good communication in the team. 
                        </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

            <!-- START EQUIPMENT AND INVENTORY SYSTEM -->
            <div class="col-6">
                <div class="demo-card-wide mdl-card mdl-shadow--2dp">
                  <div class="mdl-card__title">
                    <h2 class="mdl-card__title-text">Equipment and Inventory System</h2>
                  </div>
                  <div class="mdl-card__supporting-text">
                    <div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
                      <div class="mdl-tabs__tab-bar">
                        <a href="#video-panel" class="mdl-tabs__tab is-active">Video</a>
                        <a href="#desc-panel" class="mdl-tabs__tab">Description &amp; Code</a>
                      </div>                          
                      <div class="mdl-tabs__panel is-active" id="video-panel">
                        <iframe width="660" height="315" src="https://www.youtube.com/embed/ijDse7tpp_k?rel=0&amp;showinfo=0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                      </div>
                      <div class="mdl-tabs__panel" id="desc-panel">
                          <h3>What it is</h3> 
                          <p>
                            Standard type of equipment and inventory system created in Unreal Engine 4 with Blueprints. 
                          </p>
                      
                        <h3>What I did</h3>                      
                          <p>
                            A GUI to navigate and use items and an inventory component that handles the actual inventory. 
                            The inventory has categories and different ruleset for each category. Some items can stack while some are unique.
                            You can use, drop, equip and unequip items depending on what type of item it is.
                          </p>                         
                        
                          <p><strong>Part of blueprint to add items to inventory:</strong></p>
                          <div class="gallery">
                              <a href="images/inventoryadd.png" data-caption="Part of blueprint to add items to inventory">
                                <img src="images/inventoryadd.png" class="blueprint-image" alt="Part of blueprint to add items to inventory"/>
                              </a>
                            </div>

                      </div>
                    </div>
                  </div>
                </div>
              </div>
          </div>
          <!-- PROJECTS END -->
    </div>
    <footer>
        <a class="linkedin" href="http://www.linkedin.com/in/jimmy-s-hansson">
          <img src="icons/linkedin.png" alt="My LinkedIn account" />
        </a>
    </footer>
    <script type="text/javascript" src="js/vidim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/8.6.0/lazyload.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="js/animatedModal.min.js"></script>
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <script src="js/prism.js"></script>
    <script src="js/baguetteBox.min.js"></script>
    <script>
        new LazyLoad();
        $("#echo-link").animatedModal({modalTarget:'echomodal', animationDuration: '.4s', color:'#000'});
        $("#climbing-link").animatedModal({modalTarget:'climbingmodal', animationDuration: '.4s', color:'#fff'});
        $("#throwmotion-link").animatedModal({modalTarget:'throwmotionmodal', animationDuration: '.4s', color:'#c9cfdb'});

        var demo2 = new vidim( '#hero', {
          src: 'https://youtu.be/NMUr2yNALhU',
          type: 'YouTube',
          poster: 'https://s3-eu-west-1.amazonaws.com/originalexe/vidim/videos/Symmetric-Traffic.jpg'
        });
        
        baguetteBox.run('.gallery', {});

        // Accordion for code
        var accItem = document.getElementsByClassName('accordionItem');
        var accHD = document.getElementsByClassName('accordionItemHeading');
        for (i = 0; i < accHD.length; i++) {
            accHD[i].addEventListener('click', toggleItem, false);
        }
        function toggleItem() {
            var itemClass = this.parentNode.className;
            for (i = 0; i < accItem.length; i++) {
                accItem[i].className = 'accordionItem close';
            }
            if (itemClass == 'accordionItem close') {
                this.parentNode.className = 'accordionItem open';
            }
        }
    </script>
  </body>
</html>
